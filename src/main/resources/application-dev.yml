server:
  port: ${SERVER_PORT:8080}

spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/ttelgo_dev
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:Post@gre_2026}
    driver-class-name: org.postgresql.Driver
  
  # Mail Configuration (Gmail SMTP)
  mail:
    host: ${MAIL_HOST:smtp.gmail.com}
    port: ${MAIL_PORT:587}
    # REQUIRED: Set MAIL_USERNAME and MAIL_PASSWORD environment variables
    # For local dev: $env:MAIL_USERNAME="support@ttelgo.com"
    # For production: Set in .env file on server
    username: ${MAIL_USERNAME:}
    password: ${MAIL_PASSWORD:}
    from: ${MAIL_FROM:support@ttelgo.com}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 10000
          timeout: 10000
          writetimeout: 10000
          ssl:
            trust: "*"
    default-encoding: UTF-8
    hikari:
      pool-name: ttelgo-hikari-dev
      maximum-pool-size: ${DB_POOL_MAX:10}
      minimum-idle: ${DB_POOL_MIN_IDLE:2}
      connection-timeout: ${DB_POOL_CONNECTION_TIMEOUT_MS:30000}
      validation-timeout: ${DB_POOL_VALIDATION_TIMEOUT_MS:5000}
      idle-timeout: ${DB_POOL_IDLE_TIMEOUT_MS:600000}
      max-lifetime: ${DB_POOL_MAX_LIFETIME_MS:1800000}
      leak-detection-threshold: ${DB_POOL_LEAK_DETECTION_MS:0}
  
  jpa:
    hibernate:
      ddl-auto: update  # Update schema without dropping data (preserves data on restart)
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          time_zone: UTC
        default_batch_fetch_size: 50
  
  flyway:
    enabled: false  # Disable Flyway completely, use Hibernate DDL

esimgo:
  api:
    endpoint: https://api.esim-go.com/v2.4
    # REQUIRED: Set ESIMGO_API_KEY environment variable
    # For local dev: $env:ESIMGO_API_KEY="your_key"
    # For production: Set in .env file on server
    key: ${ESIMGO_API_KEY:}

stripe:
  secret:
    # Use environment variable STRIPE_SECRET_KEY, or fallback to working key
    # For local dev, set: $env:STRIPE_SECRET_KEY="sk_test_..." (optional if using fallback)
    # For production: Set in .env file on server
    key: ${STRIPE_SECRET_KEY:sk_test_******}
  publishable:
    # Use environment variable STRIPE_PUBLISHABLE_KEY, or fallback to working key
    # For local dev, set: $env:STRIPE_PUBLISHABLE_KEY="pk_test_..." (optional if using fallback)
    # For production: Set in .env file on server
    key: ${STRIPE_PUBLISHABLE_KEY:pk_test_******}
  webhook:
    # Use environment variable STRIPE_WEBHOOK_SECRET, or fallback to working key
    # For local dev, set: $env:STRIPE_WEBHOOK_SECRET="whsec_..." (optional if using fallback)
    # For production: Set in .env file on server
    secret: ${STRIPE_WEBHOOK_SECRET:whsec_******}

jwt:
  # REQUIRED: Set JWT_SECRET environment variable (minimum 256 bits)
  # For local dev: $env:JWT_SECRET="your-secret-key-minimum-256-bits"
  # For production: Set in .env file on server
  secret: ${JWT_SECRET:ttelgo-super-secret-key-for-development-minimum-256-bits-required-for-hmac-sha256}
  expiration: ${JWT_EXPIRATION:86400000}  # 24 hours in milliseconds
  refresh-expiration: ${JWT_REFRESH_EXPIRATION:604800000}  # 7 days in milliseconds

logging:
  level:
    root: INFO
    com.tiktel.ttelgo: DEBUG

management:
  health:
    redis:
      enabled: false
  endpoint:
    health:
      show-details: always

